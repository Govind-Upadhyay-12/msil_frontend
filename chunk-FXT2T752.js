import{a as z,b as P}from"./chunk-OZC4UA4Q.js";import{a as q,b as f,c as k,d as A,e as O,f as R,g as V,h as L,m as B,n as U,o as G}from"./chunk-AERWOUOB.js";import{Aa as F,C as l,Ca as D,D as p,Da as N,Fa as j,G as E,K as c,M as m,O as s,P as n,Q as h,S as v,T as b,V as a,ca as w,da as S,ea as I,n as C,s as x,t as _,ta as T,va as M,ya as y}from"./chunk-2I5E5T3I.js";function Y(i,r){i&1&&(s(0,"span",33),a(1," Required! "),n())}function Z(i,r){if(i&1&&(s(0,"div"),c(1,Y,2,0,"span",26),n()),i&2){let u=b();l(),m("ngIf",u.addForm.get("category").errors.required&&u.isSubmitted)}}function ee(i,r){i&1&&(s(0,"span",33),a(1," Required! "),n())}function te(i,r){if(i&1&&(s(0,"div"),c(1,ee,2,0,"span",26),n()),i&2){let u=b();l(),m("ngIf",u.addForm.get("module_name").errors.required&&u.isSubmitted)}}function ie(i,r){i&1&&(s(0,"span",33),a(1,"Required! "),n())}function re(i,r){i&1&&(s(0,"span",33),a(1," Required! "),n())}function oe(i,r){if(i&1&&(s(0,"div"),c(1,re,2,0,"span",26),n()),i&2){let u=b();l(),m("ngIf",u.addForm.get("content").errors.required&&u.isSubmitted)}}function ne(i,r){i&1&&(s(0,"span",33),a(1," Required! "),n())}function se(i,r){if(i&1&&(s(0,"div"),c(1,ne,2,0,"span",26),n()),i&2){let u=b();l(),m("ngIf",u.addForm.get("duration").errors.required&&u.isSubmitted)}}var H=(()=>{let r=class r{constructor(e,t,o,d,g,K,Q,X){this.pipe=e,this.toastr=t,this.spinner=o,this.userService=d,this.router=g,this.renderer=K,this.fb=Q,this.activatedRoute=X,this.dtOptions={},this.isSubmitted=!1,this.isSubmitted1=!1,this.sampleFile=F.api_url+"/sample.csv"}ngOnInit(){this.getCourses(),this.addForm=this.fb.group({category:["",[f.required]],module_name:["",f.required],file:["",f.required],content:["",f.required],duration:["",f.required]})}onFileChanged(e){let t=e.target.files[0];t?this.selectedFile=t:(this.selectedFile=null,this.toastr.error("Invalid File Format","Error"))}createCourse(){this.spinner.show();var e=new FormData;e.append("category",this.addForm.value.category),e.append("module_name",this.addForm.value.module_name),e.append("file",this.selectedFile?this.selectedFile:null,this.selectedFile?this.selectedFile.name:null),e.append("content",this.addForm.value.content),e.append("duration",this.addForm.value.duration),this.userService.createCourse(e).subscribe(t=>{this.spinner.hide(),t.statusCode===200?($("#Modal01").modal("hide"),this.toastr.success(t.message,"Success"),this.router.navigateByUrl("/dashboard",{skipLocationChange:!0}).then(()=>this.router.navigate(["/courses"]))):this.toastr.error(t.message,"Error")},t=>{this.spinner.hide(),this.toastr.error(t.message,"Error")})}editCourse(e){this.spinner.show(),this.userService.editCourse({id:e}).subscribe(t=>{this.spinner.hide(),t.statusCode===200?t.data&&($("#Modal02").modal("show"),this.editForm.patchValue(t.data)):this.toastr.error(t.message,"Error")},t=>{this.spinner.hide(),this.toastr.error("Something went wrong","Error")})}updateCourse(){this.spinner.show(),this.userService.updateCourse(this.editForm.value).subscribe(e=>{this.spinner.hide(),e.statusCode===200?($("#Modal02").modal("hide"),this.toastr.success(e.message,"Success"),this.router.navigateByUrl("/dashboard",{skipLocationChange:!0}).then(()=>this.router.navigate(["/courses"]))):this.toastr.error(e.message,"Error")},e=>{this.spinner.hide(),this.toastr.error("Something went wrong","Error")})}deleteCourse(e){confirm("Are you sure you want to delete this Course ?")&&(this.spinner.show(),this.userService.deleteCourse({id:e}).subscribe(t=>{this.spinner.hide(),t.statusCode===200?(this.toastr.success(t.message,"Success"),this.router.navigateByUrl("/dashboard",{skipLocationChange:!0}).then(()=>this.router.navigate(["/courses"]))):this.toastr.error(t.message,"Error")},t=>{this.spinner.hide(),this.toastr.error("Something went wrong","Error")}))}selectFile(e){if(this.checkFileValid(e.target.files.item(0))){this.selectedFile=e.target.files.item(0),this.spinner.show();let o="file_"+new Date().getTime()+"."+this.selectedFile.name.split(".").pop();var t=new FormData;t.append("file",this.selectedFile,o),this.userService.uploadCourses(t).subscribe({next:d=>{this.spinner.hide(),d.statusCode===200?($("#Modal01").modal("hide"),this.toastr.success(d.message,"Success"),this.router.navigateByUrl("/dashboard",{skipLocationChange:!0}).then(()=>this.router.navigate(["/courses"]))):this.toastr.error(d.message,"Error")},error:d=>{console.log(d),this.spinner.hide()}})}}checkFileValid(e){return console.log(e.type),["text/csv"].indexOf(e.type)!==-1?e.size/1e3<=5e3?!0:(this.toastr.error("File Size must be less then 5 Mb","Error"),!1):(this.toastr.error("Invalid File","Error"),!1)}getCourses(){this.dtOptions={pagingType:"full_numbers",pageLength:10,serverSide:!0,processing:!1,lengthMenu:[10,50,100,500,1e3],order:[5,"desc"],ajax:(e,t)=>{this.spinner.show(),this.userService.getCourses(e).subscribe(o=>{this.spinner.hide(),o.statusCode===200?t({recordsTotal:o.recordsTotal,recordsFiltered:o.recordsFiltered,data:o.courses}):(this.spinner.hide(),this.toastr.error(o.message,"Error"))},o=>{t({recordsTotal:0,recordsFiltered:[],data:[]}),this.spinner.hide(),this.toastr.error("Something Went Wrong!","Error")})},columns:[{title:"Category",data:"category",name:"category"},{title:"Module Name",data:"module_name",name:"module_name",orderable:!1},{title:"Model ",data:"videoLink",name:"videoLink",render:(e,t,o)=>(e=`${e?`<a title="Download" href="${F.api_url+"/uploads/"+e}" target="_blank" download>${e}<a>`:""}<a href="javascript:void(0)"><a/>`,e)},{title:"Content",data:"content",name:"content",orderable:!1},{title:"Duration",data:"duration",name:"duration",orderable:!1},{title:"Created&nbsp;On",data:"created_at",name:"created_at",render:e=>this.pipe.transform(e,"short")},{title:"Action",data:"id",name:"id",orderable:!1,searchable:!1,render(e,t,o){return`
           
            <a href="javascript:void(0)">
            <i class="fa fa-trash text-danger" title="Delete" delete-id=`+e+`>
            </i>
            </a>
            
           `}}],dom:"Bfrtip",buttons:["pageLength",{extend:"print",title:"Courses",exportOptions:{columns:[0,1,3,4]}},{extend:"excel",text:"Download",title:"Courses",exportOptions:{columns:[0,1,3,4]}}],responsive:!0}}ngAfterViewInit(){this.listener=this.renderer.listen("document","click",e=>{e.target.hasAttribute("edit-id")&&this.editCourse(e.target.getAttribute("edit-id")),e.target.hasAttribute("delete-id")&&this.deleteCourse(e.target.getAttribute("delete-id"))})}ngOnDestroy(){this.listener&&this.listener()}};r.\u0275fac=function(t){return new(t||r)(p(S),p(N),p(j),p(D),p(M),p(E),p(B),p(T))},r.\u0275cmp=x({type:r,selectors:[["app-courses"]],decls:60,vars:7,consts:[[1,"main-content"],[1,"page-content"],[1,"container-fluid"],[1,"row"],[1,"col-12"],[1,"page-title-box","d-sm-flex","align-items-center","justify-content-between"],[1,"mb-sm-0","font-size-18"],[2,"float","right"],["data-bs-toggle","modal","data-bs-target","#Modal01",1,"btn","btn-primary"],[1,"card"],[1,"card-body"],["id","usersTable","datatable","",1,"table","table-bordered","dataTable",2,"width","100%",3,"dtOptions"],["id","Modal01","tabindex","-1","role","dialog","aria-hidden","true",1,"modal","fade","bs-example-modal-center"],[1,"modal-dialog","modal-dialog-centered"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-bs-dismiss","modal","aria-label","Close",1,"btn-close"],[1,"modal-body"],["role","form",3,"ngSubmit","formGroup"],[1,"mb-3"],["type","text","name","category","formControlName","category","placeholder","Category",1,"form-control"],[4,"ngIf"],["type","text","name","module_name","formControlName","module_name","placeholder","Module Name",1,"form-control"],[1,"form-label"],["type","file","formControlName","file",1,"form-control",3,"change"],["class","text-danger",4,"ngIf"],["type","text","name","content","formControlName","content","placeholder","Content",1,"form-control"],["type","number","name","duration","formControlName","duration","placeholder","Duration",1,"form-control"],[1,"modal-footer"],["type","submit",1,"btn","btn-primary",3,"click"],[1,"text-center"],["type","file","name","file","accept",".csv",1,"form-control",3,"change"],[1,"text-danger"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"h4",6),a(7,"Courses"),n(),s(8,"span",7)(9,"button",8),a(10,"Add New"),n()()()()(),s(11,"div",3)(12,"div",4)(13,"div",9)(14,"div",10),h(15,"table",11),n()()()()()()(),s(16,"div",12)(17,"div",13)(18,"div",14)(19,"div",15)(20,"h5",16),a(21,"Add Course"),n(),h(22,"button",17),n(),s(23,"div",18)(24,"form",19),v("ngSubmit",function(){return o.addForm.valid&&o.createCourse()}),s(25,"div",20)(26,"label"),a(27,"Category"),n(),h(28,"input",21),c(29,Z,2,1,"div",22),n(),s(30,"div",20)(31,"label"),a(32,"Module Name"),n(),h(33,"input",23),c(34,te,2,1,"div",22),n(),s(35,"div",20)(36,"label",24),a(37,"Model(.fbx/.obj)"),n(),s(38,"input",25),v("change",function(g){return o.onFileChanged(g)}),n(),c(39,ie,2,0,"span",26),n(),s(40,"div",20)(41,"label"),a(42,"Content"),n(),h(43,"input",27),c(44,oe,2,1,"div",22),n(),s(45,"div",20)(46,"label"),a(47,"Duration"),n(),h(48,"input",28),c(49,se,2,1,"div",22),n(),s(50,"div",29)(51,"button",30),v("click",function(){return o.isSubmitted=!0}),a(52,"Save"),n()(),s(53,"div",31)(54,"label"),a(55,"OR"),n()(),s(56,"div",20)(57,"label"),a(58,"Import From CSV File "),n(),s(59,"input",32),v("change",function(g){return o.selectFile(g)}),n()()()()()()()),t&2&&(l(15),m("dtOptions",o.dtOptions),l(9),m("formGroup",o.addForm),l(5),m("ngIf",o.addForm.get("category").errors&&o.isSubmitted),l(5),m("ngIf",o.addForm.get("module_name").errors&&o.isSubmitted),l(5),m("ngIf",o.isSubmitted&&!o.selectedFile),l(5),m("ngIf",o.addForm.get("content").errors&&o.isSubmitted),l(5),m("ngIf",o.addForm.get("duration").errors&&o.isSubmitted))},dependencies:[w,z,O,q,R,k,A,V,L]});let i=r;return i})();var ae=[{path:"",component:H}],J=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=_({type:r}),r.\u0275inj=C({imports:[y.forChild(ae),y]});let i=r;return i})();var Ie=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=_({type:r}),r.\u0275inj=C({providers:[S],imports:[I,J,P,U,G]});let i=r;return i})();export{Ie as CoursesModule};
